basePath: /re-identification-system
domain: teknoir.cloud
mediaServiceBaseUrl: https://teknoir.cloud/victra-poc/media-service/api

image:
  repository: us-docker.pkg.dev/teknoir/gcr.io/re-identification-system
  tag: latest

mongo:
  image:
    repository: mongo
    tag: "8.0"
    pullPolicy: Always
  auth:
    username: teknoir
    password: change-me
  service:
    port: 27017
  resources:
    requests:
      cpu: 250m
      memory: 512Mi
    limits:
      cpu: 1
      memory: 1Gi

event-processing-pipeline:
  enabled: true

  streams:
    - stream: cloud-line-crossing
      image:
        repository: us-docker.pkg.dev/teknoir/gcr.io/observatory-event-processing
        tag: feature-line-crossing-cloud-stream-6afbeda
      mongodbSecretKeyRef:
        name: re-id-mongo
        key: uri
      serviceAccountName: default-editor
      instructor:
        model: "reid-visual-attribute-3-consolidated-prompt"
        prompt: |
          You are a vision assistant that extracts a compact set of clothing attributes used for re-ID of persons across multiple camera angles.
          Return STRICT JSON ONLY (no prose) including every schema key exactly: one_piece, outerwear, top_wear, bottom_wear, footwear, footwear_color, head_covering, skin_tone,
          outerwear_color, top_wear_color, bottom_wear_color, head_covering_color, one_piece_color,
          outerwear_pattern, top_wear_pattern, bottom_wear_pattern, head_covering_pattern, one_piece_pattern,
          and *_confidence per key as floats in [0,1]. Do not omit keys.
          Values must be lowercase and from these vocabularies:
          one_piece: dress|jumpsuit|romper|coverall|none|unknown
          outerwear: jacket|coat|hoodie|vest|sweater|none|unknown
          top_wear: t-shirt|shirt|blouse|sweater|hoodie|polo|none|unknown
          bottom_wear: pants|jeans|shorts|skirt|none|unknown
          footwear: athletic shoes|boots|dress shoes|sandals|unknown
          footwear_color: black|white|gray|brown|red|blue|green|yellow|multicolor|unknown
          outerwear_color|top_wear_color|bottom_wear_color|head_covering_color|one_piece_color: black|white|gray|brown|red|blue|green|yellow|multicolor|unknown
          head_covering: cap|beanie|hat|hoodie|none|unknown
          skin_tone: light|medium|dark|unknown
          outerwear_pattern|top_wear_pattern|bottom_wear_pattern|head_covering_pattern|one_piece_pattern: plain|patterned|logo_writing|unknown
          Notes:
          Multi-frame rule: Only use 'unknown' if NO image shows the attribute. If at least one image shows it, choose the majority value; if tie, prefer the more specific category (e.g., beanie over hat). For *_color, if colors conflict across frames, use 'multicolor' instead of 'unknown'.
          Badge/Lanyard rule: Employees frequently wear badges or lanyards. If they are wearing one over a plain shirt, make sure to mark the top_wear_pattern as 'plain'. It's also common for employees to wear a badge or lanyard over a tshirt with a logo. In that instance, mark the top_wear_pattern as 'logo_writing'.
          Head covering rule: If a person is wearing a durag, mark head_covering as 'beanie'.
          Delivery person rule: UPS drivers frequently wear brown uniforms where it looks like they are wearing a one_piece 'coverall'. These are not coveralls but uniforms with matching brown outerwear 'shirt' and bottom_wear 'pants' or 'shorts'.
          Color mapping rules:
          * pink, peach, or orange -> 'red'
          * purple -> 'blue'
          * orange -> 'yellow'
          Shoe rules:
          *If a shoe appears to mainly be one color with a clearly different colored sole, use 'multicolor'
          *If a person is wearing Crocs (closed toe with lots of holes and a strap at the back) mark footwear as 'sandals'.
          Shirt rules:
          *If a top_wear is short sleeve and has buttons below the chest, mark it as a 'shirt' instead of a 'polo'.
          *If the top_wear appears to be a 't-shirt' but has a distinguishable collar, mark it as a 'polo'.
          *Striped top_wear should be marked as 'patterned'.
          *If a shirt has a face on it, mark it as 'logo_writing'.
          *Shirts with a tiny logo on a sleeve should be marked as 'plain' (they may not be visible from multiple camera angles).
          *Sweatshirts without a hood should be marked as 'sweater'.
          Ripped jeans rule: If jeans are ripped, mark them as 'patterned'.
          If a woman is wearing a burqa, mark one_piece as 'dress', 'head_covering' as 'unknown', 'top_wear' as 'none', 'bottom_wear' as 'none'.
          If a person is wearing leggings, mark bottom_wear as 'pants'.
          If a person is wearing a tracksuit, mark top_wear as 'sweater' and bottom_wear as 'pants'.
          If an article of clothing is both patterned and has a logo, mark it as 'patterned'.

          Extract the requested attributes for the visible person. Follow the schema strictly.

triton:
  enabled: true

  models:
    - name: swin-reid
      image: us-docker.pkg.dev/teknoir/gcr.io/swin-reid-triton:latest-local-20251112-104202